{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap dad9991641694c10a756","webpack:///./lib/index.js","webpack:///./lib/map/index.js","webpack:///./lib/map/google.js","webpack:///./lib/map/leaflet.js"],"names":["Map","require","Interactive","map","gridUrl","_map","_cache","_url","_eventEmitter","dispatchEvent","event","data","_listeners","move","click","out","addEventListener","callback","removeEventListener","undefined","tilejson","grids","_bindMap","on","_onMapClick","bind","_onMapMouseMove","e","coords","_getTileCoordsFromMouseEvent","_loadTile","z","x","y","then","_objectForEvent","tileSize","pixelPoint","project","_unscale","getZoom","scale","Math","floor","Promise","resolve","fetch","_buildTileUrl","json","url","replace","eventType","point","resolution","gridX","gridY","max","pow","tile","grid","idx","_utfDecode","charCodeAt","key","keys","hasOwnProperty","originalEvent","_triggerEvent","extendedEvent","c","module","exports","GoogleMap","LeafletMap","nativeMap","__gm","latLng","getProjection","fromLatLngToPoint","addListener","latlng"],"mappings":"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","file":"gridjson.bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"gridjson\"] = factory();\n\telse\n\t\troot[\"gridjson\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap dad9991641694c10a756","var Map = require('./map');\n\n/**\n * \n */\nclass Interactive {\n    constructor(map, gridUrl) {\n        this._map = map && new Map(map);\n        this._cache = {};\n        this._url = gridUrl;\n        // At the moment only a callback is required\n        this._eventEmitter = {\n            dispatchEvent: (event, data) => {\n                switch (event) {\n                    case 'mousemove':\n                        this._listeners.move && this._listeners.move(data);\n                        break;\n                    case 'click':\n                        this._listeners.click && this._listeners.click(data);\n                        break;\n                    case 'featureout':\n                        this._listeners.out && this._listeners.out();\n                }\n            },\n            addEventListener: (event, callback) => {\n                switch (event) {\n                    case 'mousemove':\n                        this._listeners.move = callback;\n                        break;\n                    case 'click':\n                        this._listeners.click = callback;\n                        break;\n                    case 'featureout':\n                        this._listeners.out = callback;\n                }\n            },\n            removeEventListener: (event) => {\n                switch (event) {\n                    case 'mousemove':\n                        delete this._listeners.move;\n                        break;\n                    case 'click':\n                        delete this._listeners.click;\n                        break;\n                    case 'featureout':\n                        delete this._listeners.out;\n                }\n            }\n        }\n\n        this._listeners = {\n            click: undefined,\n            move: undefined,\n            out: undefined,\n        }\n    }\n\n    /**\n     * Add the grid url from a tilejson file\n     * @deprecated\n     * Method added for backwards compatibility.\n     */\n    tilejson(tilejson) {\n        this._url = tilejson.grids[0];\n        return this;\n    }\n\n    /**\n     * Add the native map \n     * @deprecated\n     * Method added for backwards compatibility.\n     */\n    map(map) {\n        this._map = new Map(map);\n        this._bindMap();\n        return this;\n    }\n\n    _bindMap() {\n        this._map.on('click', this._onMapClick.bind(this));\n        this._map.on('mousemove', this._onMapMouseMove.bind(this));\n    }\n\n    /**\n     * Attach event listeners to map events\n     * @param {*} event \n     * @param {*} callback \n     */\n    on(event, callback) {\n        switch (event) {\n            case 'on':\n                this._eventEmitter.addEventListener('mousemove', callback)\n                this._eventEmitter.addEventListener('click', callback)\n                break;\n            case 'off':\n                this._eventEmitter.addEventListener('featureout', callback)\n                break;\n            default:\n        }\n        return this;\n    }\n\n    /**\n     * Callback executed when the native map click event is fired\n     * @param {*} e \n     */\n    _onMapClick(e) {\n        var coords = this._getTileCoordsFromMouseEvent(e);\n        this._loadTile(coords.z, coords.x, coords.y).then(() => this._objectForEvent(e, 'click'));\n    }\n\n    /**\n     * Callback executed when the native map \"mousemove\" event is fired.\n     * @param {*} e \n     */\n    _onMapMouseMove(e) {\n        var coords = this._getTileCoordsFromMouseEvent(e);\n        this._loadTile(coords.z, coords.x, coords.y).then(() => this._objectForEvent(e, 'mousemove'));\n    }\n\n    /**\n     * Return the tile coordinates from a mouseEvent\n     * @param {*} mouseEvent \n     */\n    _getTileCoordsFromMouseEvent(event) {\n        var tileSize = 256;\n        var pixelPoint = this._map.project(event);\n        var coords = this._unscale(pixelPoint, tileSize);\n        coords.z = this._map.getZoom() // { x: 212, y: 387, z: 10 }\n        return coords;\n    }\n\n    _unscale(pixelPoint, scale) {\n        return {\n            x: Math.floor(pixelPoint.x / scale),\n            y: Math.floor(pixelPoint.y / scale),\n        }\n    }\n\n    /**\n     * Load a grid.json tile from the coords using a cache system to improve performance.\n     * @param {*} z \n     * @param {*} x \n     * @param {*} y \n     */\n    _loadTile(z, x, y) {\n        // If already cached the request is ignored.\n        if (this._cache[z + '_' + x + '_' + y]) {\n            return Promise.resolve();\n        }\n        // Prevent duplicated requests. The value will be async obtained.\n        this._cache[z + '_' + x + '_' + y] = 'fetching';\n        return fetch(this._buildTileUrl(z, x, y))\n            .then(data => data.json())\n            .then(data => this._cache[z + '_' + x + '_' + y] = data);\n    }\n\n    /**\n     * Builds the tile url from the coords.\n     * @param {*} z \n     * @param {*} x \n     * @param {*} y \n     */\n    _buildTileUrl(z, x, y) {\n        let url = this._url;\n        url = url.replace(/{z}/, z);\n        url = url.replace(/{x}/, x);\n        url = url.replace(/{y}/, y);\n        return url;\n    }\n\n    /**\n     * \n     */\n    _objectForEvent(e, eventType) {\n        var point = this._map.project(e);\n        var tileSize = 256;\n        var resolution = 4; // 4 pixels asigned to each grid in the utfGrid.\n\n        var x = Math.floor(point.x / tileSize);\n        var y = Math.floor(point.y / tileSize);\n\n        var gridX = Math.floor((point.x - (x * tileSize)) / resolution);\n        var gridY = Math.floor((point.y - (y * tileSize)) / resolution);\n\n        var max = Math.pow(2, this._map.getZoom());\n\n        x = (x + max) % max;\n        y = (y + max) % max;\n\n        var tile = this._cache[this._map.getZoom() + '_' + x + '_' + y];\n\n        var data;\n        if (tile && tile.grid) {\n            var idx = this._utfDecode(tile.grid[gridY].charCodeAt(gridX));\n            var key = tile.keys[idx];\n            if (tile.data.hasOwnProperty(key)) {\n                data = tile.data[key];\n            }\n        }\n        // Extend the event with the data from the grid json\n        e.data = data;\n        e.e = e.originalEvent;\n        this._triggerEvent(eventType, e);\n\n    }\n\n    /**\n     */\n    _triggerEvent(eventType, extendedEvent) {\n        // If there is no data dont do anything!\n        if (!extendedEvent.data) {\n            this._eventEmitter.dispatchEvent('featureout', {});\n            return;\n        }\n        if (eventType === 'mousemove') {\n            this._eventEmitter.dispatchEvent('mousemove', extendedEvent);\n            return;\n        }\n        if (eventType === 'click') {\n            this._eventEmitter.dispatchEvent('featureout', {});\n            this._eventEmitter.dispatchEvent('click', extendedEvent);\n        }\n    }\n\n    /**\n     * Remove interactivity\n     */\n    remove() {\n        this._eventEmitter.removeEventListener(this._listeners.click);\n        this._eventEmitter.removeEventListener(this._listeners.move);\n        this._eventEmitter.removeEventListener(this._listeners.out);\n    }\n\n    /**\n     * Decode an utf gridjson cell\n     * @see https://github.com/mapbox/utfgrid-spec/blob/master/1.3/utfgrid.md\n     * @param {*} c \n     */\n    _utfDecode(c) {\n        if (c >= 93) {\n            c--;\n        }\n        if (c >= 35) {\n            c--;\n        }\n        return c - 32;\n    }\n}\n\n\nmodule.exports = { Interactive };\n\n\n// WEBPACK FOOTER //\n// ./lib/index.js","var GoogleMap = require('./google');\nvar LeafletMap = require('./leaflet');\n\nfunction Map(nativeMap) {\n    if (nativeMap.__gm) {\n        return new GoogleMap(nativeMap);\n    }\n    else {\n        return new LeafletMap(nativeMap);\n    }\n\n}\nmodule.exports = Map;\n\n\n// WEBPACK FOOTER //\n// ./lib/map/index.js","class GoogleMap {\n    constructor(nativeMap) {\n        this._map = nativeMap;\n    }\n\n    /**\n     * Return the pixel coordinates of an event at a certain zoom level.\n     */\n    project(event) {\n        const latLng = event.latLng;\n        const point = this._map.getProjection().fromLatLngToPoint(latLng);\n        const scale = Math.pow(2, this.getZoom());\n        return {\n            x: Math.floor(scale * point.x),\n            y: Math.floor(scale * point.y),\n        }\n    }\n\n    getZoom() {\n        return this._map.getZoom();\n    }\n\n    on(event, callback) {\n        this._map.addListener(event, callback);\n    }\n}\n\nmodule.exports = GoogleMap;\n\n\n// WEBPACK FOOTER //\n// ./lib/map/google.js","class LeafletMap {\n    constructor(nativeMap) {\n        this._map = nativeMap;\n    }\n\n    // LatLong to pixel coords\n    project(event) {\n        const latlng = event.latlng;\n        return this._map.project(latlng, this._map.getZoom()).floor()\n    }\n\n    getZoom() {\n        return this._map.getZoom();\n    }\n\n    on(event, callback) {\n        this._map.on(event, callback);\n    }\n}\n\nmodule.exports = LeafletMap;\n\n\n// WEBPACK FOOTER //\n// ./lib/map/leaflet.js"],"sourceRoot":""}